<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>User Login / Registration</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap');
    * { font-family: 'Poppins', sans-serif; }
    body { background-color: #0f172a; }
    .fade { transition: all 0.4s ease; }
  </style>
</head>
<body class="flex items-center justify-center min-h-screen text-white">

  <div id="auth-card"
       class="fade flex flex-col justify-center w-full max-w-80 rounded-xl px-6 py-8 border border-slate-700 bg-slate-900 text-sm">
       
    <!-- Login Form -->
    <div id="login-form">
      <h2 class="text-2xl font-semibold">Sign In</h2>
      <p class="text-slate-300 mt-1">Login to your account</p>
      <form class="mt-8" id="loginForm">
        <label for="login-id" class="block mb-1 font-medium text-slate-300">User ID</label>
        <input type="text" id="login-id" name="userid" placeholder="User ID"
          class="w-full p-2 mb-3 bg-slate-900 border border-slate-700 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500">

        <label for="login-password" class="block mb-1 font-medium text-slate-300">Password</label>
        <input type="password" id="login-password" name="password" placeholder="Password"
          class="w-full p-2 mb-2 bg-slate-900 border border-slate-700 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500">

        <button type="submit"
          class="w-full mt-8 px-4 py-2.5 font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">Sign in</button>
      </form>
      <p class="text-center text-slate-400 text-xs mt-6">
        Donâ€™t have an account?
        <button onclick="showRegister()" class="text-indigo-500 font-medium hover:underline">Register</button>
      </p>
    </div>

    <!-- Register Form -->
    <div id="register-form" class="hidden fade">
      <h2 class="text-2xl font-semibold">Create Account</h2>
      <p class="text-slate-300 mt-1">Register a new account</p>
      <form class="mt-8" id="registerForm">
        <label for="reg-id" class="block mb-1 font-medium text-slate-300">User ID</label>
        <input type="text" id="reg-id" placeholder="User ID"
          class="w-full p-2 mb-3 bg-slate-900 border border-slate-700 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500">

        <label for="reg-mobile" class="block mb-1 font-medium text-slate-300">Mobile Number</label>
        <input type="text" id="reg-mobile" placeholder="Mobile Number"
          class="w-full p-2 mb-3 bg-slate-900 border border-slate-700 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500">

        <label for="reg-password" class="block mb-1 font-medium text-slate-300">Password</label>
        <input type="password" id="reg-password" placeholder="Password"
          class="w-full p-2 mb-3 bg-slate-900 border border-slate-700 rounded-md focus:outline-none focus:ring-1 focus:ring-indigo-500">

        <button type="submit"
          class="w-full mt-8 px-4 py-2.5 font-medium text-white bg-indigo-600 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500">Register</button>
      </form>
      <p class="text-center text-slate-400 text-xs mt-6">
        Already have an account?
        <button onclick="showLogin()" class="text-indigo-500 font-medium hover:underline">Sign In</button>
      </p>
    </div>
  </div>

  <script>
    const loginFormDiv = document.getElementById('login-form');
    const registerFormDiv = document.getElementById('register-form');
    const registerForm = document.getElementById('registerForm');
    const loginForm = document.getElementById('loginForm');

    function showRegister() {
      loginFormDiv.classList.add('hidden');
      registerFormDiv.classList.remove('hidden');
    }

    function showLogin() {
      registerFormDiv.classList.add('hidden');
      loginFormDiv.classList.remove('hidden');
    }

    // Handle registration
    registerForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const userid = document.getElementById('reg-id').value.trim();
      const mobile = document.getElementById('reg-mobile').value.trim();
      const password = document.getElementById('reg-password').value;

      if (!userid || !mobile || !password) {
        alert('Please fill all fields.');
        return;
      }

      const formData = new FormData();
      formData.append('userid', userid);
      formData.append('mobile', mobile);
      formData.append('password', password);

      const res = await fetch('http://127.0.0.1:5000/register', { method: 'POST', body: formData });
      const msg = await res.text();
      alert(msg);
      if (msg.includes('success')) showLogin();
    });

    // Handle login
    loginForm.addEventListener('submit', async (e) => {
      e.preventDefault();
      const userid = document.getElementById('login-id').value.trim();
      const password = document.getElementById('login-password').value;

      if (!userid || !password) {
        alert('Please enter User ID and Password.');
        return;
      }

      const formData = new FormData();
      formData.append('userid', userid);
      formData.append('password', password);

      const res = await fetch('http://127.0.0.1:5000/login', { method: 'POST', body: formData });
      const msg = await res.text();

      if (msg.includes('success')) {
        window.location.href = 'http://127.0.0.1:5000/welcome';
      } else {
        alert(msg);
      }
    });
  </script>
</body>
</html>
